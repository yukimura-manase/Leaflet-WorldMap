<html lang="ja" style="height: 100%; margin: 0;">
<head>
    <meta charset="UTF-8">

    <!-- Leafletã®Libraryã‚’Loadã™ã‚‹ -->
    <link rel="stylesheet" href="./node_modules/leaflet/dist/leaflet.css" />
    <script src="./node_modules/leaflet/dist/leaflet.js"></script>

    <title>Leaflet-MarkerEvent</title>
</head>

<!-- Leafletã‚’å…¨é¢è¡¨ç¤ºã§è¨­å®šã™ã‚‹ -->
<body style="height: 100%; margin: 0; overflow: hidden;">
    <div id="map" style="height: 100%; width:100%;" ></div>
</body>

<script>

    // [ Leaflet ã§ Marker-Click-Eventã‚’å®Ÿè£…ã™ã‚‹ ]

    // 1. Markeræƒ…å ±ã‚’ä¿æŒã™ã‚‹List
    const markerList = [];

    // 2. Map-Instanceã‚’ä½œæˆã™ã‚‹
    const map = L.map('map', {
        doubleClickZoom: false,
        scrollWheelZoom: false,
        boxZoom: false,
        tap: false,
        keyboard: false, 
        zoomControl: false,
    })
    .setView([51.5, -0.09], 3);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',
        maxZoom: 5, // maxZoom: ã‚ºãƒ¼ãƒ ãƒ¬ãƒ™ãƒ«ã®æœ€å¤§å€¤ã‚’æŒ‡å®šã—ã¾ã™ã€‚
        minZoom: 2,  // minZoom: ã‚ºãƒ¼ãƒ ãƒ¬ãƒ™ãƒ«ã®æœ€å°å€¤ã‚’æŒ‡å®šã—ã¾ã™ã€‚
    }).addTo(map);

    // Clickã‚¤ãƒ™ãƒ³ãƒˆã§ç™ºç«ã™ã‚‹é–¢æ•°
    function ClickEvent (e){
        console.log(`${e.target.name} ã®Country-Code = ${e.target.country_code}`);;
    }

    // 3. Marker-Instanceã«å¯¾ã—ã¦ã€.on('click', CallBackFunc) ã§Clickã‚¤ãƒ™ãƒ³ãƒˆã®é–¢æ•°ã‚’ç™»éŒ²ï¼
    const japan = L.marker([35.68, 139.69]).addTo(map).on('click', (e) => {
        ClickEvent(e);
    });

    // 4. è¿½åŠ ã—ãŸã„å€¤ã‚’Setã™ã‚‹ã€‚
    japan.country_code = 1;
    japan.name = 'æ—¥æœ¬';

    console.log({japan});

    markerList.push(japan);

    const britain = L.marker([51.5, -0.09]).addTo(map).on('click', (e) => {
        ClickEvent(e);
    });

    britain.country_code = 2;
    britain.name = 'ã‚¤ã‚®ãƒªã‚¹';

    const buttonTag = `
        <button 
            type="button" 
            onclick="location.href='https://masanyon.com/'" 
            style="margin-top: 5px;"
        >
            No Change No Life I/O
        </button>
    `;

    const america = L.marker([38.9, -77.01]).addTo(map)
    .bindPopup(`å¤–éƒ¨ã‚µã‚¤ãƒˆã€No Change No Life I/Oã€ã«Pageé·ç§»ã—ã¾ã™ğŸ”¥ <br> ${buttonTag}`)
    .on('click', () => { console.log('ã‚¢ãƒ¡ãƒªã‚«åˆè¡†å›½ã€ä¸‡æ­³ğŸ”¥'); });

    const germany = L.marker([52.5, 13.4]).addTo(map)
    .bindPopup(`å¤–éƒ¨ã‚µã‚¤ãƒˆã€No Change No Life I/Oã€ã«Pageé·ç§»ã—ã¾ã™ğŸ”¥ <br> ${buttonTag}`)
    .on('click', () => { console.log('ãƒ‰ã‚¤ãƒ„ã®ç§‘å­¦ã¯ã€ä¸–ç•Œä¸€ãƒãƒãƒãƒãƒãƒãƒãƒğŸ”¥'); });


    // [ å‚è€ƒãƒ»å¼•ç”¨ ]
    // 1. Leaflet ãƒãƒ¼ã‚«ãƒ¼ã‚¯ãƒªãƒƒã‚¯ã‚¤ãƒ™ãƒ³ãƒˆ
    // https://www.achiachi.net/blog/leaflet/clickevent


</script>

</html>